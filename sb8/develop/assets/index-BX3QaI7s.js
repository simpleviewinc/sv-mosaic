import{r as u,R as t}from"./index-D0AnReJb.js";import{s as g}from"./styled-components.browser.esm-8X0uN6v9.js";import{u as h,f as D,F as v,g as S,h as I}from"./index-C9jB5BV3.js";import{D as V}from"./DataViewPrimaryFilter-DbuXG1-l.js";import{B as C,t as R}from"./sizes-DkIXWPpc.js";import{t as a}from"./testIds-DLbO0bd9.js";import{a as O,D as y}from"./DataViewFilterDropdownButtons-j8BN_zxt.js";import{a as L}from"./Button-BdEZ7jiv.js";import{a as F}from"./formats-CMvQHWsT.js";import{B as m}from"./Badge-nT9K5bgY.js";import{a as x}from"./useMosaicTranslation-di9nduwf.js";const b=g.div`
	display: flex;
	flex-direction: column;
	justify-content: space-between;
	width: ${C.sm};
`,w=g.div`
	display: flex;
	flex-direction: row;
`,W=g.div`
	display: flex;
	flex-direction: column;
`,k=g.ul`
	border-right: 2px solid ${R.newColors.grey2[100]};
	margin: 0;
	padding: 0;
	flex: 1 1 0%;
	min-height: 0;
	max-width: 130px;
	max-height: 284px;
	overflow-y: auto;
`,B=[{fields:[[["rangeStart"],["rangeEnd"]]],gridMinWidth:C.sm}];function N(e){const o=h({data:{rangeStart:"rangeStart"in e?e.rangeStart:void 0,rangeEnd:"rangeEnd"in e?e.rangeEnd:void 0}}),{state:r,methods:{setFormValues:s}}=o,{rangeStart:l,rangeEnd:i}=r.data,[T,_]=u.useState("selectedOption"in e?e.selectedOption:void 0),d=u.useMemo(()=>[{name:"rangeStart",type:"date",label:"From",size:"full",inputSettings:{fixedTime:[0,0,0,0],maxDate:i},validators:[{fn:D,options:{endDateName:"rangeEnd"}}],validates:["rangeEnd"]},{name:"rangeEnd",type:"date",label:"To",size:"full",inputSettings:{fixedTime:[23,59,59,999],minDate:l},validators:[{fn:D,options:{startDateName:"rangeStart"}}],validates:["rangeStart"]}],[i,l]),n=u.useCallback(E=>{e.onChange({option:E}),e.onClose()},[e.onChange,e.onClose]),c=u.useCallback(()=>{s({values:{rangeStart:void 0,rangeEnd:void 0},validate:!0}),_(void 0)},[s]),f=u.useCallback(()=>{!l&&!i?e.onChange(void 0):e.onChange({rangeStart:l,rangeEnd:i}),e.onClose()},[e.onChange,e.onClose,l,i]),A=Object.values(r.errors).filter(Boolean).length>0;return t.createElement(w,{"data-testid":a.DATA_VIEW_FILTER_DATE_CONTENT},"options"in e&&e.options&&t.createElement(W,null,t.createElement(k,{"data-testid":a.DATA_VIEW_FILTER_DATE_OPTIONS},e.options.map(E=>t.createElement(L,{key:E.value,label:E.label,selected:T===E.value,color:"blue",onClick:()=>n(E.value),truncateText:!0,title:!0})))),t.createElement(b,null,t.createElement("div",{"data-testid":"dataview-filter-date-inputs"},t.createElement(v,{...o,fields:d,sections:B,fullHeight:!1,spacing:"compact",autoFocus:!0})),t.createElement(O,{onApply:f,onClear:c,disableApply:A})))}const P=g.span``;function Z(e){var o,r,s;const[l,i]=u.useState(null),T=function(n){i(n.currentTarget)},_=function(){i(null)};let d;if(e.data){if("rangeStart"in e.data||"rangeEnd"in e.data){const n=e.data.rangeStart!==void 0,c=e.data.rangeEnd!==void 0,f=n?S(e.data.rangeStart,F):void 0,A=c?S(e.data.rangeEnd,F):void 0;I(e.data.rangeStart,e.data.rangeEnd)?d=t.createElement(m,{attrs:{"data-testid":a.DATA_VIEW_FILTER_VALUE}},f):n&&c?d=t.createElement(t.Fragment,null,t.createElement(m,{attrs:{"data-testid":a.DATA_VIEW_FILTER_VALUE}},f),t.createElement("span",{"data-testid":a.DATA_VIEW_FILTER_OPERATOR},"to"),t.createElement(m,{attrs:{"data-testid":a.DATA_VIEW_FILTER_VALUE}},A)):n?d=t.createElement(t.Fragment,null,t.createElement("span",{"data-testid":a.DATA_VIEW_FILTER_OPERATOR},"from"),t.createElement(m,{attrs:{"data-testid":a.DATA_VIEW_FILTER_VALUE}},f)):d=t.createElement(t.Fragment,null,t.createElement("span",{"data-testid":a.DATA_VIEW_FILTER_OPERATOR},"to"),t.createElement(m,{attrs:{"data-testid":a.DATA_VIEW_FILTER_VALUE}},A))}else if("option"in e.data&&e.data.option!==void 0&&e.args.options!==void 0){const n=e.args.options.find(({value:c})=>"option"in e.data&&c===e.data.option);n&&(d=t.createElement(m,{attrs:{"data-testid":a.DATA_VIEW_FILTER_VALUE}},n.label))}}return t.createElement(P,null,t.createElement(V,{label:e.label,value:d,onClick:T}),t.createElement(y,{anchorEl:l,onClose:_},t.createElement(N,{onClose:_,onChange:e.onChange,rangeStart:e.data&&"rangeStart"in e.data?(o=e.data)===null||o===void 0?void 0:o.rangeStart:void 0,rangeEnd:e.data&&"rangeEnd"in e.data?(r=e.data)===null||r===void 0?void 0:r.rangeEnd:void 0,options:e.args.options,selectedOption:e.data&&"option"in e.data?(s=e.data)===null||s===void 0?void 0:s.option:void 0,minDate:e==null?void 0:e.args.minDate})))}const U={choose_a_date___:"Choose a date..."},M={en:U};x({prefix:"DataViewFilterDate",bundle:M});export{Z as D};
