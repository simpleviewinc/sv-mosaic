import{g as k,r as d,R as a}from"./index-D0AnReJb.js";import{E as P}from"./ExpandMore-Ca3pe8z0.js";import{r as V}from"./identifier-DOqdnZ6L.js";import{r as L}from"./createSvgIcon-DDyBApXB.js";import{r as H}from"./jsx-runtime-EKYJJIwR.js";import{C as N}from"./Chip-CuRU8A0j.js";import{a as F}from"./MosaicContext-Y61KIvFP.js";import{u as q}from"./FormFieldText.styled-DQ22Tenv.js";import{t as M}from"./testIds-oQNwr1rf.js";import{a as B}from"./DataViewFilterDropdownButtons-B-tY8L0F.js";import{B as D}from"./Button-Dlaq5vsb.js";import{B as j}from"./ButtonRow-BcTDDHHE.js";import{C as $}from"./StyledPopperPaper-BODJ-ail.js";import"./DataViewPrimaryFilter.styled-Ej2pGgIE.js";import"./Badge-D14GCFVi.js";import{s as C}from"./styled-components.browser.esm-8X0uN6v9.js";import{P as G,a as W}from"./PickerPanel-sTfyWN5V.js";import{t as T}from"./sizes-DkIXWPpc.js";import"./Typography-CZQzWHyE.js";import{T as R}from"./Text-BjwqtcAz.js";import"./index-Bqzh3Cp6.js";var E={},O;function z(){if(O)return E;O=1;var v=V();Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var e=v(L()),c=H();return E.default=(0,e.default)((0,c.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 17h-2v-2h2zm2.07-7.75-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25"}),"Help"),E}var K=z();const U=k(K),J=C(G)`
	width: 530px;
	height: 344px;
`,Q=C(R).attrs({tag:"h3",size:"lg"})`
	margin-bottom: ${T.spacing(2)};
`,X=C.div`
	padding: 10px;
`,Y=C(W)`
	max-width: 220px;
`,Z=C.div`
	margin-bottom: ${T.spacing(3)};
`,ee=C(R).attrs({size:"lg",weight:"medium",tag:"h3"})`
	margin-bottom: ${T.spacing(3)};
`;function te({getOptions:v,limit:e,onCreateNew:c}){const m=Math.abs(e)||25,[r,s]=d.useState({hasMore:!1,isLoading:!1,options:[],skip:0,keyword:void 0}),w=d.useRef({options:[]}),i=d.useRef({index:0,map:new Map}),f=d.useCallback(({limit:l,skip:u=0,keyword:p,append:_,debounced:y})=>{const h=i.current.index;i.current.index++,i.current.map.forEach(o=>{o.cancelled=!0,o.timer&&clearTimeout(o.timer)});const t=async()=>{s(S=>({...S,isLoading:!0,hasMore:!1,...!p&&!_?w.current:{}}));const{docs:o,hasMore:n}=await v({limit:l,skip:u,keyword:p}),g=i.current.map.get(h);if(!g||g.cancelled){i.current.map.delete(h);return}!p&&!_&&(w.current={options:o}),s(S=>({...S,options:_?[...S.options,...o]:o,hasMore:n===!0,skip:u,isLoading:!1})),i.current.map.clear()};y?i.current.map.set(h,{timer:setTimeout(()=>t(),200),cancelled:!1}):(i.current.map.set(h,{cancelled:!1}),t())},[v]);d.useEffect(()=>{f({limit:m})},[f,m]);const x=d.useMemo(()=>{if(r.hasMore)return()=>f({limit:m,skip:r.skip+m,keyword:r.keyword,append:!0})},[f,m,r.hasMore,r.keyword,r.skip]),I=l=>{s(u=>({...u,hasMore:!1})),f({limit:m,keyword:l||void 0,debounced:!0})},b=d.useMemo(()=>{if(c)return async l=>{const u=await c(l);return s(p=>({...p,options:[...p.options,u]})),u}},[c]);return{state:r,reset:()=>s(l=>({...l,keyword:void 0})),loadMore:x,debouncedSetKeyword:I,createNewOption:b}}function Ie({createNewOption:v,...e}){const[c,m]=d.useState(e.comparison),[r,s]=d.useState(e.selected),{state:w,loadMore:i,reset:f,debouncedSetKeyword:x,createNewOption:I}=te({getOptions:e.getOptions,limit:e.limit,onCreateNew:v}),{t:b}=q(),A=e.comparisons?e.comparisons.find(t=>t.value===c):void 0,l=e.selectLimit>0&&r.length>=e.selectLimit||["exists","not_exists"].includes(c),u=function(){m("in"),s([]),f()},p=function(){e.onApply({value:l?[]:r.map(({value:t})=>t),comparison:c})};let _;if(e.comparisons){const t=e.comparisons.map(n=>({label:n.label,onClick:function(){s(g=>["exists","not_exists"].includes(n.value)?[]:g),m(n.value)}})),o={In:"The row must match one of selected option.","Not In":"The row must match none of the selected options.",All:"The row must match all of the selected options.",Exists:"The row must have a value for this filter.","Not Exists":"The row must not have a value for this filter."};_=a.createElement(Z,{"data-testid":M.DATA_VIEW_FILTERS_COMPARISON},a.createElement(Q,null,b("mosaic:DataView.comparison")),a.createElement(j,null,a.createElement(D,{label:A.label,variant:"contained",intent:"secondary",iconPosition:"right",mIcon:P,menuItems:t,muiAttrs:{"aria-label":"Comparison Selector"}}),a.createElement(D,{variant:"text",intent:"info",mIcon:U,popover:a.createElement(X,{"data-testid":M.COMPARISON_HELP},t.map((n,g)=>a.createElement("span",{key:g},a.createElement("b",null,n.label)," ","-"," ",o[n.label],a.createElement("br",null)))),muiAttrs:{"aria-label":"Comparison Help"}})))}const y=async function(t){var o;const n=[...t];(o=e.onChange)===null||o===void 0||o.call(e,n),s(n)},h=t=>{s(o=>o.filter(n=>n.value!==t.value))};return a.createElement("div",{"data-testid":M.DATA_VIEW_FILTER_MULTI_CONTENT},a.createElement(J,{options:w.options,checked:r,disabled:l,activePanel:a.createElement(Y,{"data-testid":M.DATA_VIEW_FILTER_MULTI_ACTIVE,$rounded:!0},_,a.createElement(ee,null,b("mosaic:DataView.selected_options")),a.createElement($,{$align:"start",$gap:[3]},r.map(t=>a.createElement(N,{key:t.value,label:t.label,onDelete:()=>h(t),fullWidth:!0})))),onChange:y,onKeywordChange:x,onLoadMore:w.hasMore?i:void 0,onCreateNew:I,isLoading:w.isLoading}),!e.hideButtons&&a.createElement(B,{onApply:p,onClear:u}))}const ae={actions:"Actions",clear_filters:"Clear filters",column_order:"Column Order",columns:"Columns",comparison:"Comparison",default:"Default",default_view:"Default View",filters:"Filters",go:"Go",jump_to_page:"Jump to Page",label:"Label",mine:"Mine",more:"More",overwrite_current_view:"Overwrite Current View",page:"Page",remove:"Remove",save_as:"Save As",view:"View",save_as_new_view:"Save as New View",save_view:"Save View",saved_views:"Saved Views",no_view_selected:"No view selected",selected_options:"Selected Options",show_for_all_users:"Show for all Users",column_settings:"Column Settings",type:"Type",cancel_save_view:"Cancel save view",cancel_saved_views:"Cancel saved views",cancel_column_settings:"Cancel column settings"},oe={clear_filters:"Limpiar filtros",columns:"Columnas",default_view:"Vista predeterminada",filters:"Filtros",jump_to_page:"Ir a la página",more:"Más",overwrite_current_view:"Sobrescribir vista actual",save_as:"Guardar como",save_as_new_view:"Guardar como nueva vista",save_view:"Guardar Vista"},ne={en:ae,es:oe};F({prefix:"DataView",bundle:ne});export{Ie as D,Y as S,ee as a,ne as l,te as u};
