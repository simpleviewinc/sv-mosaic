import{g as P,r as p,R as a}from"./index-D0AnReJb.js";import{E as V}from"./ExpandMore-Dl7LJMh2.js";import{r as k}from"./identifier-Bktyv6O_.js";import{r as L}from"./createSvgIcon-D5aI0OD-.js";import{r as H}from"./jsx-runtime-EKYJJIwR.js";import{C as N}from"./Chip-D4exI_Oq.js";import{u as F,a as q}from"./useMosaicTranslation-di9nduwf.js";import{t as x}from"./testIds-DLbO0bd9.js";import{a as B}from"./DataViewFilterDropdownButtons-Bd_5anyu.js";import{B as D}from"./Button-BOlAo_yO.js";import{B as j}from"./ButtonRow-Dil46hZf.js";import{C as $}from"./StyledPopperPaper-BxcX73gl.js";import"./DataViewPrimaryFilter.styled-ChQqXjcm.js";import"./Badge.styled-qjrvmt6O.js";import{s as C}from"./styled-components.browser.esm-C5LJ_neh.js";import{P as G,a as W}from"./PickerPanel-tAAYph5M.js";import{t as T}from"./sizes-_ON_TzAH.js";import"./Typography-DBsSg8HG.js";import{T as R}from"./Text-ChOjGkiI.js";import"./index-Bqzh3Cp6.js";var E={},O;function z(){if(O)return E;O=1;var f=k();Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var e=f(L()),l=H();return E.default=(0,e.default)((0,l.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 17h-2v-2h2zm2.07-7.75-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25"}),"Help"),E}var K=z();const U=P(K),J=C(G)`
	width: 530px;
	height: 344px;
`,Q=C(R).attrs({tag:"h3",size:"lg"})`
	margin-bottom: ${T.spacing(2)};
`,X=C.div`
	padding: 10px;
`,Y=C(W)`
	max-width: 220px;
`,Z=C.div`
	margin-bottom: ${T.spacing(3)};
`,ee=C(R).attrs({size:"lg",weight:"medium",tag:"h3"})`
	margin-bottom: ${T.spacing(3)};
`;function te({getOptions:f,limit:e,onCreateNew:l}){const m=Math.abs(e)||25,[u,s]=p.useState({hasMore:!1,isLoading:!1,options:[],skip:0,keyword:void 0}),v=p.useRef({options:[]}),r=p.useRef({index:0,map:new Map}),w=p.useCallback(({limit:i,skip:c=0,keyword:d,append:_,debounced:y})=>{const h=r.current.index;r.current.index++,r.current.map.forEach(o=>{o.cancelled=!0,o.timer&&clearTimeout(o.timer)});const t=async()=>{s(S=>({...S,isLoading:!0,hasMore:!1,...!d&&!_?v.current:{}}));const{docs:o,hasMore:n}=await f({limit:i,skip:c,keyword:d}),g=r.current.map.get(h);if(!g||g.cancelled){r.current.map.delete(h);return}!d&&!_&&(v.current={options:o}),s(S=>({...S,options:_?[...S.options,...o]:o,hasMore:n===!0,skip:c,isLoading:!1})),r.current.map.clear()};y?r.current.map.set(h,{timer:setTimeout(()=>t(),200),cancelled:!1}):(r.current.map.set(h,{cancelled:!1}),t())},[f]);p.useEffect(()=>{w({limit:m})},[w,m]);const I=()=>w({limit:m,skip:u.skip+m,keyword:u.keyword,append:!0}),M=i=>{s(c=>({...c,hasMore:!1})),w({limit:m,keyword:i||void 0,debounced:!0})},b=p.useMemo(()=>{if(l)return async i=>{const c=await l(i);return s(d=>({...d,options:[...d.options,c]})),c}},[l]);return{state:u,reset:()=>s(i=>({...i,keyword:void 0})),loadMore:I,debouncedSetKeyword:M,createNewOption:b}}function Ie({createNewOption:f,...e}){const[l,m]=p.useState(e.comparison),[u,s]=p.useState(e.selected),{state:v,loadMore:r,reset:w,debouncedSetKeyword:I,createNewOption:M}=te({getOptions:e.getOptions,limit:e.limit,onCreateNew:f}),{t:b}=F(),A=e.comparisons?e.comparisons.find(t=>t.value===l):void 0,i=e.selectLimit>0&&u.length>=e.selectLimit||["exists","not_exists"].includes(l),c=function(){m("in"),s([]),w()},d=function(){e.onApply({value:i?[]:u.map(({value:t})=>t),comparison:l})};let _;if(e.comparisons){const t=e.comparisons.map(n=>({label:n.label,onClick:function(){s(g=>["exists","not_exists"].includes(n.value)?[]:g),m(n.value)}})),o={In:"The row must match one of selected option.","Not In":"The row must match none of the selected options.",All:"The row must match all of the selected options.",Exists:"The row must have a value for this filter.","Not Exists":"The row must not have a value for this filter."};_=a.createElement(Z,{"data-testid":x.DATA_VIEW_FILTERS_COMPARISON},a.createElement(Q,null,b("mosaic:DataView.comparison")),a.createElement(j,null,a.createElement(D,{label:A.label,variant:"contained",intent:"secondary",iconPosition:"right",mIcon:V,menuItems:t,muiAttrs:{"aria-label":"Comparison Selector"}}),a.createElement(D,{variant:"text",intent:"info",mIcon:U,popover:a.createElement(X,{"data-testid":x.COMPARISON_HELP},t.map((n,g)=>a.createElement("span",{key:g},a.createElement("b",null,n.label)," ","-"," ",o[n.label],a.createElement("br",null)))),muiAttrs:{"aria-label":"Comparison Help"}})))}const y=async function(t){var o;const n=[...t];(o=e.onChange)===null||o===void 0||o.call(e,n),s(n)},h=t=>{s(o=>o.filter(n=>n.value!==t.value))};return a.createElement("div",{"data-testid":x.DATA_VIEW_FILTER_MULTI_CONTENT},a.createElement(J,{options:v.options,checked:u,disabled:i,activePanel:a.createElement(Y,{"data-testid":x.DATA_VIEW_FILTER_MULTI_ACTIVE,$rounded:!0},_,a.createElement(ee,null,b("mosaic:DataView.selected_options")),a.createElement($,{$align:"start",$gap:[3]},u.map(t=>a.createElement(N,{key:t.value,label:t.label,onDelete:()=>h(t),fullWidth:!0})))),onChange:y,onKeywordChange:I,onLoadMore:v.hasMore?r:void 0,onCreateNew:M,isLoading:v.isLoading}),!e.hideButtons&&a.createElement(B,{onApply:d,onClear:c}))}const ae={actions:"Actions",clear_filters:"Clear filters",column_order:"Column Order",columns:"Columns",comparison:"Comparison",default:"Default",default_view:"Default View",filters:"Filters",go:"Go",jump_to_page:"Jump to Page",label:"Label",mine:"Mine",more:"More",overwrite_current_view:"Overwrite Current View",page:"Page",remove:"Remove",save_as:"Save As",view:"View",save_as_new_view:"Save as New View",save_view:"Save View",saved_views:"Saved Views",no_view_selected:"No view selected",selected_options:"Selected Options",show_for_all_users:"Show for all Users",column_settings:"Column Settings",type:"Type",cancel_save_view:"Cancel save view",cancel_saved_views:"Cancel saved views",cancel_column_settings:"Cancel column settings"},oe={clear_filters:"Limpiar filtros",columns:"Columnas",default_view:"Vista predeterminada",filters:"Filtros",jump_to_page:"Ir a la página",more:"Más",overwrite_current_view:"Sobrescribir vista actual",save_as:"Guardar como",save_as_new_view:"Guardar como nueva vista",save_view:"Guardar Vista"},ne={en:ae,es:oe};q({prefix:"DataView",bundle:ne});export{Ie as D,Y as S,ee as a,ne as l,te as u};
