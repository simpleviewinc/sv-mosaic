import{g as R,r as d,R as a}from"./index-D0AnReJb.js";import{E as P}from"./ExpandMore-CEbXN-sG.js";import{r as V}from"./identifier-C21A9frq.js";import{r as L}from"./createSvgIcon-DLboviGw.js";import{r as H}from"./jsx-runtime-EKYJJIwR.js";import{C as N}from"./Chip-BMBxB4HT.js";import{u as F,a as q}from"./useMosaicTranslation-CoWLI8L7.js";import{t as x}from"./testIds-BKutUmNQ.js";import{a as B}from"./DataViewFilterDropdownButtons-B-NSlGS8.js";import{B as D}from"./Button-Cu24UfKA.js";import{B as j}from"./ButtonRow-DEKalGfm.js";import{P as $,a as G,C as W}from"./PickerPanel-CJUaTFnG.js";import"./DataViewPrimaryFilter.styled-DJMCb03L.js";import{s as g}from"./styled-components.browser.esm-aVcmUYMZ.js";import{t as T}from"./sizes-CTdyEcea.js";import"./Typography-DM2nLVeQ.js";import{T as O}from"./Text-Bw6wJuVZ.js";var E={},k;function z(){if(k)return E;k=1;var p=V();Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var e=p(L()),c=H();return E.default=(0,e.default)((0,c.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 17h-2v-2h2zm2.07-7.75-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25"}),"Help"),E}var K=z();const U=R(K),J=g($)`
	width: 530px;
	height: 344px;
`,Q=g(O).attrs({tag:"h3",size:"lg"})`
	margin-bottom: ${T.spacing(2)};
`,X=g.div`
	padding: 10px;
`,Y=g(G)`
	max-width: 220px;
`,Z=g.div`
	margin-bottom: ${T.spacing(3)};
`,ee=g(O).attrs({size:"lg",weight:"medium",tag:"h3"})`
	margin-bottom: ${T.spacing(3)};
`;function te({getOptions:p,limit:e,onCreateNew:c}){const u=Math.abs(e)||25,[s,r]=d.useState({hasMore:!1,isLoading:!1,options:[],skip:0,keyword:void 0}),f=d.useRef({options:[]}),i=d.useRef({index:0,map:new Map}),v=d.useCallback(({limit:l,skip:m=0,keyword:C,append:w,debounced:M})=>{const _=i.current.index;i.current.index++,i.current.map.forEach(o=>{o.cancelled=!0,o.timer&&clearTimeout(o.timer)});const t=async()=>{r(S=>({...S,isLoading:!0,hasMore:!1,...!C&&!w?f.current:{}}));const{docs:o,hasMore:n}=await p({limit:l,skip:m,keyword:C}),h=i.current.map.get(_);if(!h||h.cancelled){i.current.map.delete(_);return}!C&&!w&&(f.current={options:o}),r(S=>({...S,options:w?[...S.options,...o]:o,hasMore:n===!0,skip:m,isLoading:!1})),i.current.map.clear()};M?i.current.map.set(_,{timer:setTimeout(()=>t(),200),cancelled:!1}):(i.current.map.set(_,{cancelled:!1}),t())},[p]);d.useEffect(()=>{v({limit:u})},[v,u]);const I=()=>v({limit:u,skip:s.skip+u,keyword:s.keyword,append:!0}),y=l=>{r(m=>({...m,hasMore:!1})),v({limit:u,keyword:l||void 0,debounced:!0})},b=d.useMemo(()=>{if(c)return async()=>{const l=await c(s.keyword);r(m=>({...m,options:[...m.options,l]}))}},[c,s.keyword]);return{state:s,reset:()=>r(l=>({...l,keyword:void 0})),loadMore:I,debouncedSetKeyword:y,createNewOption:b}}function be({createNewOption:p,...e}){const[c,u]=d.useState(e.comparison),[s,r]=d.useState(e.selected),{state:f,loadMore:i,reset:v,debouncedSetKeyword:I,createNewOption:y}=te({getOptions:e.getOptions,limit:e.limit,onCreateNew:p}),{t:b}=F(),A=e.comparisons?e.comparisons.find(t=>t.value===c):void 0,l=e.selectLimit>0&&s.length>=e.selectLimit||["exists","not_exists"].includes(c),m=function(){u("in"),r([]),v()},C=function(){e.onApply({value:l?[]:s.map(({value:t})=>t),comparison:c})};let w;if(e.comparisons){const t=e.comparisons.map(n=>({label:n.label,onClick:function(){r(h=>["exists","not_exists"].includes(n.value)?[]:h),u(n.value)}})),o={In:"The row must match one of selected option.","Not In":"The row must match none of the selected options.",All:"The row must match all of the selected options.",Exists:"The row must have a value for this filter.","Not Exists":"The row must not have a value for this filter."};w=a.createElement(Z,{"data-testid":x.DATA_VIEW_FILTERS_COMPARISON},a.createElement(Q,null,b("mosaic:DataView.comparison")),a.createElement(j,null,a.createElement(D,{label:A.label,variant:"outlined",color:"black",iconPosition:"right",mIcon:P,menuItems:t,muiAttrs:{"aria-label":"Comparison Selector"}}),a.createElement(D,{variant:"icon",color:"blue",mIcon:U,popover:a.createElement(X,{"data-testid":x.COMPARISON_HELP},t.map((n,h)=>a.createElement("span",{key:h},a.createElement("b",null,n.label)," ","-"," ",o[n.label],a.createElement("br",null)))),muiAttrs:{"aria-label":"Comparison Help"}})))}const M=async function(t){var o;const n=[...t];(o=e.onChange)===null||o===void 0||o.call(e,n),r(n)},_=t=>{r(o=>o.filter(n=>n.value!==t.value))};return a.createElement("div",{"data-testid":x.DATA_VIEW_FILTER_MULTI_CONTENT},a.createElement(J,{options:f.options,checked:s,disabled:l,activePanel:a.createElement(Y,{"data-testid":x.DATA_VIEW_FILTER_MULTI_ACTIVE},w,a.createElement(ee,null,b("mosaic:DataView.selected_options")),a.createElement(W,{$align:"start",$gap:[3]},s.map(t=>a.createElement(N,{key:t.value,label:t.label,onDelete:()=>_(t),fullWidth:!0})))),onChange:M,onKeywordChange:I,onLoadMore:f.hasMore?i:void 0,onCreateNew:y,isLoading:f.isLoading}),!e.hideButtons&&a.createElement(B,{onApply:C,onClear:m}))}const ae={actions:"Actions",clear_filters:"Clear filters",column_order:"Column Order",columns:"Columns",comparison:"Comparison",default:"Default",default_view:"Default View",filters:"Filters",go:"Go",jump_to_page:"Jump to Page",label:"Label",mine:"Mine",more:"More",overwrite_current_view:"Overwrite Current View",page:"Page",remove:"Remove",save_as:"Save As",view:"View",save_as_new_view:"Save as New View",save_view:"Save View",saved_views:"Saved Views",no_view_selected:"No view selected",selected_options:"Selected Options",show_for_all_users:"Show for all Users",column_settings:"Column Settings",type:"Type",cancel_save_view:"Cancel save view",cancel_saved_views:"Cancel saved views",cancel_column_settings:"Cancel column settings"},oe={clear_filters:"Limpiar filtros",columns:"Columnas",default_view:"Vista predeterminada",filters:"Filtros",jump_to_page:"Ir a la página",more:"Más",overwrite_current_view:"Sobrescribir vista actual",save_as:"Guardar como",save_as_new_view:"Guardar como nueva vista",save_view:"Guardar Vista"},ne={en:ae,es:oe};q({prefix:"DataView",bundle:ne});export{be as D,Y as S,ee as a,ne as l,te as u};
